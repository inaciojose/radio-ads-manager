<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Radio Ads Manager</title>
    <link rel="stylesheet" href="css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="logo">
        <i class="fas fa-radio"></i>
        <h2>Radio Ads</h2>
      </div>

      <nav class="nav-menu">
        <a
          href="#dashboard"
          class="nav-item active"
          onclick="showPage('dashboard', event)"
        >
          <i class="fas fa-chart-line"></i>
          <span>Dashboard</span>
        </a>
        <a
          href="#clientes"
          class="nav-item"
          data-auth-only="true"
          style="display: none"
          onclick="showPage('clientes', event)"
        >
          <i class="fas fa-users"></i>
          <span>Clientes</span>
        </a>
        <a
          href="#contratos"
          class="nav-item"
          data-auth-only="true"
          style="display: none"
          onclick="showPage('contratos', event)"
        >
          <i class="fas fa-file-contract"></i>
          <span>Contratos</span>
        </a>
        <a
          href="#veiculacoes"
          class="nav-item"
          onclick="showPage('veiculacoes', event)"
        >
          <i class="fas fa-broadcast-tower"></i>
          <span>Veiculações</span>
        </a>
        <a
          href="#arquivos"
          class="nav-item"
          data-auth-only="true"
          style="display: none"
          onclick="showPage('arquivos', event)"
        >
          <i class="fas fa-folder-open"></i>
          <span>Arquivos</span>
        </a>
        <a
          href="#notas-fiscais"
          class="nav-item"
          data-auth-only="true"
          style="display: none"
          onclick="showPage('notas-fiscais', event)"
        >
          <i class="fas fa-file-invoice"></i>
          <span>Notas Fiscais</span>
        </a>
        <a
          href="#usuarios"
          class="nav-item"
          data-auth-only="true"
          data-admin-only="true"
          style="display: none"
          onclick="showPage('usuarios', event)"
        >
          <i class="fas fa-user-shield"></i>
          <span>Usuários</span>
        </a>
      </nav>

      <div class="sidebar-footer">
        <div class="api-status">
          <span class="status-indicator" id="api-status"></span>
          <span id="api-status-text">Verificando API...</span>
        </div>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="header-left">
          <h1 id="page-title">Dashboard</h1>
        </div>
        <div class="header-right">
          <div class="auth-info">
            <span id="current-user-badge" class="badge badge-secondary">Convidado</span>
            <button id="btn-login" class="btn btn-primary" onclick="showLoginModal()">
              <i class="fas fa-sign-in-alt"></i> Iniciar Sessão
            </button>
            <button id="btn-logout" class="btn btn-secondary" onclick="logout()" style="display: none">
              <i class="fas fa-sign-out-alt"></i> Sair
            </button>
          </div>
          <div class="date-time">
            <i class="fas fa-calendar"></i>
            <span id="current-date"></span>
          </div>
          <button
            class="btn-refresh"
            onclick="refreshCurrentPage(event)"
            title="Atualizar"
          >
            <i class="fas fa-sync-alt"></i>
          </button>
        </div>
      </header>

      <!-- Pages Container -->
      <div class="content">
        <!-- Dashboard Page -->
        <div id="page-dashboard" class="page active">
          <!-- Stats Cards -->
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon blue">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-content" id="stat-clientes-content">
                <h3 id="stat-clientes">-</h3>
                <p>Clientes Ativos</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon green">
                <i class="fas fa-file-contract"></i>
              </div>
              <div class="stat-content" id="stat-contratos-content">
                <h3 id="stat-contratos">-</h3>
                <p>Contratos Ativos</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon orange">
                <i class="fas fa-broadcast-tower"></i>
              </div>
              <div class="stat-content" id="stat-veiculacoes-content">
                <h3 id="stat-veiculacoes">-</h3>
                <p>Veiculações Hoje</p>
              </div>
            </div>

            <div class="stat-card">
              <div class="stat-icon red">
                <i class="fas fa-file-invoice"></i>
              </div>
              <div class="stat-content" id="stat-nf-pendentes-content">
                <h3 id="stat-nf-pendentes">-</h3>
                <p>NFs Pendentes</p>
              </div>
            </div>

            <div class="stat-card" id="stat-meta-diaria-card">
              <div class="stat-icon info">
                <i class="fas fa-bullseye"></i>
              </div>
              <div class="stat-content" id="stat-meta-diaria-content">
                <h3 id="stat-meta-diaria">-</h3>
                <p>Meta Diária (Hoje)</p>
                <small id="stat-meta-diaria-detail">-</small>
              </div>
            </div>
          </div>

          <!-- Charts -->
          <div class="charts-grid">
            <div class="chart-card">
              <h3>Veiculações por Tipo de Programa</h3>
              <canvas id="chart-tipo-programa"></canvas>
            </div>

            <div class="chart-card">
              <h3>Top 5 Clientes (Hoje)</h3>
              <canvas id="chart-top-clientes"></canvas>
            </div>
          </div>

          <!-- Recent Activity -->
          <div class="card">
            <h3>Últimas Veiculações</h3>
            <div class="table-responsive">
              <table class="table" id="table-recent-veiculacoes">
                <thead>
                  <tr>
                    <th>Horário</th>
                    <th>Cliente</th>
                    <th>Arquivo</th>
                    <th>Programa</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="5" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Clientes Page -->
        <div id="page-clientes" class="page">
          <div class="page-header">
            <button class="btn btn-primary" data-requires-write="true" onclick="showClienteModal()">
              <i class="fas fa-plus"></i> Novo Cliente
            </button>
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="search-clientes"
                placeholder="Buscar clientes..."
                onkeyup="searchClientes()"
              />
            </div>
          </div>

          <div class="card">
            <div class="table-responsive">
              <table class="table" id="table-clientes">
                <thead>
                  <tr>
                    <th>Nome</th>
                    <th>CNPJ/CPF</th>
                    <th>Email</th>
                    <th>Telefone</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="6" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Contratos Page -->
        <div id="page-contratos" class="page">
          <div class="page-header">
            <button class="btn btn-primary" data-requires-write="true" onclick="showContratoModal()">
              <i class="fas fa-plus"></i> Novo Contrato
            </button>
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="search-contratos"
                placeholder="Buscar número/cliente..."
                onkeyup="searchContratos()"
              />
            </div>
            <div class="filters">
              <select id="filter-contrato-status" onchange="loadContratos()">
                <option value="">Todos os Status</option>
                <option value="ativo">Ativos</option>
                <option value="concluído">Concluídos</option>
                <option value="cancelado">Cancelados</option>
              </select>
              <select id="filter-contrato-nf" onchange="loadContratos()">
                <option value="">Todas as NFs</option>
                <option value="pendente">NF Pendente</option>
                <option value="emitida">NF Emitida</option>
                <option value="paga">NF Paga</option>
              </select>
              <select id="filter-contrato-frequencia" onchange="loadContratos()">
                <option value="">Todas as Frequências</option>
                <option value="ambas">Ambas</option>
                <option value="102.7">102.7</option>
                <option value="104.7">104.7</option>
              </select>
            </div>
          </div>

          <div class="card">
            <div class="table-responsive">
              <table class="table" id="table-contratos">
                <thead>
                  <tr>
                    <th>Número</th>
                    <th>Cliente</th>
                    <th>Período</th>
                    <th>Progresso</th>
                    <th>Valor</th>
                    <th>NF</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="8" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-bar">
              <button id="contratos-prev" class="btn btn-secondary" onclick="changeContratosPage(-1)">
                <i class="fas fa-chevron-left"></i> Anterior
              </button>
              <span id="contratos-page-info" class="page-info">Página 1</span>
              <button id="contratos-next" class="btn btn-secondary" onclick="changeContratosPage(1)">
                Próxima <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Veiculações Page -->
        <div id="page-veiculacoes" class="page">
          <div class="page-header">
            <div class="date-filter">
              <input
                type="date"
                id="filter-veiculacao-data"
                onchange="loadVeiculacoes()"
              />
            </div>
            <button class="btn btn-primary" data-requires-write="true" onclick="showLoteVeiculacaoModal()">
              <i class="fas fa-plus"></i> Lançar OBS em Lote
            </button>
            <button class="btn btn-success" data-requires-write="true" onclick="processarVeiculacoes()">
              <i class="fas fa-cogs"></i> Processar Veiculações
            </button>
          </div>

          <div class="card">
            <div class="freq-tabs">
              <button class="freq-tab active" onclick="setFreqTab(null, this)">Todas</button>
              <button class="freq-tab" onclick="setFreqTab('102.7', this)">102.7</button>
              <button class="freq-tab" onclick="setFreqTab('104.7', this)">104.7</button>
            </div>
            <div class="table-responsive">
              <table class="table" id="table-veiculacoes">
                <thead>
                  <tr>
                    <th>Horário</th>
                    <th>Freq.</th>
                    <th>Cliente</th>
                    <th>Arquivo</th>
                    <th>Programa</th>
                    <th>Contrato</th>
                    <th>Processado</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="7" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Arquivos Page -->
        <div id="page-arquivos" class="page">
          <div class="page-header">
            <button class="btn btn-primary" data-requires-write="true" onclick="showArquivoModal()">
              <i class="fas fa-plus"></i> Novo Arquivo
            </button>
            <div class="filters">
              <select id="filter-arquivo-status" onchange="loadArquivos()">
                <option value="">Todos</option>
                <option value="true">Ativos</option>
                <option value="false">Inativos</option>
              </select>
            </div>
          </div>

          <div class="card">
            <div class="table-responsive">
              <table class="table" id="table-arquivos">
                <thead>
                  <tr>
                    <th>Nome do Arquivo</th>
                    <th>Título</th>
                    <th>Cliente</th>
                    <th>Duração</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="6" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>

        <!-- Usuários Page -->
        <div id="page-usuarios" class="page">
          <div class="page-header">
            <button
              class="btn btn-primary"
              data-admin-only="true"
              onclick="showUsuarioModal()"
            >
              <i class="fas fa-user-plus"></i> Novo Usuário
            </button>
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                id="search-usuarios"
                placeholder="Buscar usuário..."
                onkeyup="searchUsuarios()"
              />
            </div>
          </div>

          <div class="card">
            <div class="table-responsive">
              <table class="table" id="table-usuarios">
                <thead>
                  <tr>
                    <th>Usuário</th>
                    <th>Nome</th>
                    <th>Perfil</th>
                    <th>Status</th>
                    <th>Ações</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="5" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-bar">
              <button id="usuarios-prev" class="btn btn-secondary" onclick="changeUsuariosPage(-1)">
                <i class="fas fa-chevron-left"></i> Anterior
              </button>
              <span id="usuarios-page-info" class="page-info">Página 1</span>
              <button id="usuarios-next" class="btn btn-secondary" onclick="changeUsuariosPage(1)">
                Próxima <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>

        <!-- Notas Fiscais Page -->
        <div id="page-notas-fiscais" class="page">
          <div class="page-header">
            <div class="filters">
              <input type="month" id="filter-nf-competencia" onchange="loadNotasFiscais()" />
              <select id="filter-nf-status" onchange="loadNotasFiscais()">
                <option value="">Todos os Status</option>
                <option value="pendente">Pendente</option>
                <option value="emitida">Emitida</option>
                <option value="paga">Paga</option>
                <option value="cancelada">Cancelada</option>
              </select>
              <select id="filter-nf-cliente" onchange="loadNotasFiscais()">
                <option value="">Todos os Clientes</option>
              </select>
            </div>
          </div>
          <div class="card">
            <div class="table-responsive">
              <table class="table" id="table-notas-fiscais">
                <thead>
                  <tr>
                    <th>Cliente</th>
                    <th>Contrato</th>
                    <th>Competência</th>
                    <th>Valor</th>
                    <th>Status</th>
                    <th>Número NF</th>
                    <th>Ação</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td colspan="7" class="text-center">Carregando...</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="pagination-bar">
              <button id="notas-fiscais-prev" class="btn btn-secondary" onclick="changeNotasFiscaisPage(-1)">
                <i class="fas fa-chevron-left"></i> Anterior
              </button>
              <span id="notas-fiscais-page-info" class="page-info">Página 1</span>
              <button id="notas-fiscais-next" class="btn btn-secondary" onclick="changeNotasFiscaisPage(1)">
                Próxima <i class="fas fa-chevron-right"></i>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals -->
    <div
      id="modal-backdrop"
      class="modal-backdrop"
      onclick="closeModal()"
    ></div>

    <!-- Cliente Modal -->
    <div id="modal-cliente" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="cliente-modal-title">Novo Cliente</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-cliente">
            <input type="hidden" id="cliente-id" />

            <div class="form-group">
              <label>Nome *</label>
              <input type="text" id="cliente-nome" required />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>CNPJ/CPF</label>
                <input type="text" id="cliente-cnpj" />
              </div>
              <div class="form-group">
                <label>Telefone</label>
                <input type="text" id="cliente-telefone" />
              </div>
            </div>

            <div class="form-group">
              <label>Email</label>
              <input type="email" id="cliente-email" />
            </div>

            <div class="form-group">
              <label>Endereço</label>
              <textarea id="cliente-endereco" rows="2"></textarea>
            </div>

            <div class="form-group">
              <label>Status</label>
              <select id="cliente-status">
                <option value="ativo">Ativo</option>
                <option value="inativo">Inativo</option>
              </select>
            </div>

            <div class="form-group">
              <label>Observações</label>
              <textarea id="cliente-observacoes" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">
            Cancelar
          </button>
          <button class="btn btn-primary" onclick="saveCliente()">
            Salvar
          </button>
        </div>
      </div>
    </div>

    <!-- Contrato Modal -->
    <div id="modal-contrato" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="contrato-modal-title">Novo Contrato</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-contrato">
            <input type="hidden" id="contrato-id" />

            <div class="form-group">
              <label>Cliente *</label>
              <select id="contrato-cliente" required onchange="onContratoClienteChange()"></select>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Data Início *</label>
                <input type="date" id="contrato-data-inicio" required />
              </div>
              <div class="form-group">
                <label>Data Fim</label>
                <input type="date" id="contrato-data-fim" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Frequência</label>
                <select id="contrato-frequencia">
                  <option value="ambas">Ambas</option>
                  <option value="102.7">102.7</option>
                  <option value="104.7">104.7</option>
                </select>
              </div>
              <div class="form-group">
                <label>Valor Total (R$)</label>
                <input type="number" step="0.01" min="0" id="contrato-valor-total" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Status Contrato</label>
                <select id="contrato-status-contrato">
                  <option value="ativo">Ativo</option>
                  <option value="concluído">Concluído</option>
                  <option value="cancelado">Cancelado</option>
                </select>
              </div>
              <div class="form-group">
                <label>Dinâmica NF</label>
                <select id="contrato-nf-dinamica">
                  <option value="unica">Única</option>
                  <option value="mensal">Mensal</option>
                </select>
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Status NF (Resumo)</label>
                <select id="contrato-status-nf">
                  <option value="pendente">Pendente</option>
                  <option value="emitida">Emitida</option>
                  <option value="paga">Paga</option>
                </select>
              </div>
              <div class="form-group">
                <label>Número NF (Resumo)</label>
                <input type="text" id="contrato-numero-nf" />
              </div>
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Data Emissão NF (Resumo)</label>
                <input type="date" id="contrato-data-emissao-nf" />
              </div>
            </div>

            <div id="contrato-item-create-section">
              <h4>Item do Contrato</h4>
              <div class="form-row">
                <div class="form-group">
                  <label>Tipo de Programa *</label>
                  <input type="text" id="contrato-item-tipo" placeholder="musical, esporte..." />
                </div>
                <div class="form-group">
                  <label>Meta Total</label>
                  <input type="number" min="1" id="contrato-item-quantidade" />
                </div>
                <div class="form-group">
                  <label>Meta Diária</label>
                  <input type="number" min="1" id="contrato-item-meta-diaria" />
                </div>
              </div>
              <div class="form-group">
                <label>Observações do Item</label>
                <textarea id="contrato-item-observacoes" rows="2"></textarea>
              </div>
            </div>

            <div id="contrato-item-edit-section" style="display: none">
              <h4>Itens do Contrato</h4>
              <div id="contrato-itens-edit-list"></div>
            </div>

            <div id="contrato-meta-create-section">
              <h4>Metas por Arquivo (Opcional)</h4>
              <div class="form-group">
                <button type="button" class="btn btn-secondary btn-sm" onclick="addContratoMetaCreateRow()">
                  <i class="fas fa-plus"></i> Adicionar Meta por Arquivo
                </button>
              </div>
              <div id="contrato-metas-create-list"></div>
            </div>

            <div id="contrato-meta-edit-section" style="display: none">
              <h4>Metas por Arquivo</h4>
              <div class="form-group">
                <button type="button" class="btn btn-secondary btn-sm" onclick="addContratoMetaEditRow()">
                  <i class="fas fa-plus"></i> Nova Meta por Arquivo
                </button>
              </div>
              <div id="contrato-metas-edit-list"></div>
            </div>

            <div class="form-group">
              <label>Observações</label>
              <textarea id="contrato-observacoes" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveContrato()">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Nota Fiscal Modal -->
    <div id="modal-nota-fiscal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Atualizar Nota Fiscal</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-nota-fiscal">
            <input type="hidden" id="nf-contrato-id" />
            <input type="hidden" id="nf-nota-id" />
            <div class="form-group">
              <label>Status NF *</label>
              <select id="nf-status" required>
                <option value="pendente">Pendente</option>
                <option value="emitida">Emitida</option>
                <option value="paga">Paga</option>
                <option value="cancelada">Cancelada</option>
              </select>
            </div>
            <div class="form-group">
              <label>Número NF</label>
              <input type="text" id="nf-numero" />
            </div>
            <div class="form-group">
              <label>Série</label>
              <input type="text" id="nf-serie" />
            </div>
            <div class="form-group">
              <label>Data Emissão</label>
              <input type="date" id="nf-data-emissao" />
            </div>
            <div class="form-group">
              <label>Data Pagamento</label>
              <input type="date" id="nf-data-pagamento" />
            </div>
            <div class="form-group">
              <label>Valor (R$)</label>
              <input type="number" step="0.01" min="0" id="nf-valor" />
            </div>
            <div class="form-group">
              <label>Observações</label>
              <textarea id="nf-observacoes" rows="2"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveNotaFiscal()">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Faturamento Mensal Modal -->
    <div id="modal-faturamento-mensal" class="modal modal-wide">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Faturamento Mensal</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <input type="hidden" id="faturamento-contrato-id" />

          <div class="card" style="margin-bottom: 1rem">
            <h4 id="faturamento-contrato-label">Contrato</h4>
            <div class="form-row">
              <div class="form-group">
                <label>Competência (YYYY-MM)</label>
                <input type="month" id="faturamento-competencia" />
              </div>
              <div class="form-group">
                <label>Filtro por Status</label>
                <select id="faturamento-filtro-status">
                  <option value="">Todos</option>
                  <option value="pendente">Pendente</option>
                  <option value="emitida">Emitida</option>
                  <option value="paga">Paga</option>
                  <option value="cancelada">Cancelada</option>
                </select>
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Status Inicial (criação manual)</label>
                <select id="faturamento-status-inicial">
                  <option value="pendente">Pendente</option>
                  <option value="emitida">Emitida</option>
                  <option value="paga">Paga</option>
                  <option value="cancelada">Cancelada</option>
                </select>
              </div>
              <div class="form-group">
                <label>Número NF</label>
                <input type="text" id="faturamento-numero-nf" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Data Emissão</label>
                <input type="date" id="faturamento-data-emissao" />
              </div>
              <div class="form-group">
                <label>Data Pagamento</label>
                <input type="date" id="faturamento-data-pagamento" />
              </div>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Valor Cobrado (R$)</label>
                <input type="number" step="0.01" min="0" id="faturamento-valor" />
              </div>
              <div class="form-group">
                <label>Observações</label>
                <input type="text" id="faturamento-observacoes" />
              </div>
            </div>
            <div class="faturamento-mensal-actions">
              <button class="btn btn-secondary" type="button" onclick="loadFaturamentosMensais()">
                <i class="fas fa-sync-alt"></i> Atualizar Lista
              </button>
              <button class="btn btn-primary" type="button" onclick="criarFaturamentoMensalManual()">
                <i class="fas fa-plus"></i> Criar Competência
              </button>
              <button class="btn btn-success" type="button" onclick="emitirNotaFiscalMensalAtual()">
                <i class="fas fa-file-invoice"></i> Emitir NF
              </button>
            </div>
          </div>

          <div class="table-responsive">
            <table class="table" id="table-faturamentos-mensais">
              <thead>
                <tr>
                  <th>Competência</th>
                  <th>Status</th>
                  <th>Número NF</th>
                  <th>Emissão</th>
                  <th>Pagamento</th>
                  <th>Valor</th>
                  <th>Edição</th>
                  <th>Ação</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="8" class="text-center">Carregando...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Fechar</button>
        </div>
      </div>
    </div>

    <!-- Arquivo Modal -->
    <div id="modal-arquivo" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="arquivo-modal-title">Novo Arquivo</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-arquivo">
            <input type="hidden" id="arquivo-id" />

            <div class="form-group">
              <label>Cliente *</label>
              <select id="arquivo-cliente" required></select>
            </div>

            <div class="form-group">
              <label>Nome do Arquivo *</label>
              <input type="text" id="arquivo-nome" required />
            </div>

            <div class="form-group">
              <label>Título</label>
              <input type="text" id="arquivo-titulo" />
            </div>

            <div class="form-row">
              <div class="form-group">
                <label>Duração (segundos)</label>
                <input type="number" min="0" id="arquivo-duracao" />
              </div>
              <div class="form-group">
                <label>Status</label>
                <select id="arquivo-ativo">
                  <option value="true">Ativo</option>
                  <option value="false">Inativo</option>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label>Caminho Completo</label>
              <input type="text" id="arquivo-caminho" />
            </div>

            <div class="form-group">
              <label>Observações</label>
              <textarea id="arquivo-observacoes" rows="3"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveArquivo()">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay">
      <div class="spinner"></div>
      <p>Carregando...</p>
    </div>

    <!-- Toast Notifications -->
    <div id="toast-container" class="toast-container"></div>

    <!-- Login Modal -->
    <div id="modal-login" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Iniciar Sessão</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-login" onsubmit="event.preventDefault(); login();">
            <div class="form-group">
              <label>Usuário</label>
              <input type="text" id="login-username" required />
            </div>
            <div class="form-group">
              <label>Senha</label>
              <input type="password" id="login-password" required />
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="login()">Entrar</button>
        </div>
      </div>
    </div>

    <!-- Usuário Modal -->
    <div id="modal-usuario" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="usuario-modal-title">Novo Usuário</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-usuario">
            <input type="hidden" id="usuario-id" />
            <div class="form-group">
              <label>Username *</label>
              <input type="text" id="usuario-username" required />
            </div>
            <div class="form-group">
              <label>Nome *</label>
              <input type="text" id="usuario-nome" required />
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Perfil *</label>
                <select id="usuario-role">
                  <option value="operador">Operador</option>
                  <option value="admin">Administrador</option>
                </select>
              </div>
              <div class="form-group">
                <label>Status</label>
                <select id="usuario-ativo">
                  <option value="true">Ativo</option>
                  <option value="false">Inativo</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label>Senha <span id="usuario-senha-obrigatoria">*</span></label>
              <input type="password" id="usuario-password" />
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveUsuario()">Salvar</button>
        </div>
      </div>
    </div>

    <!-- Veiculação Lote Modal -->
    <div id="modal-veiculacao-lote" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3>Lançamento Manual em Lote (OBS)</h3>
          <button class="btn-close" onclick="closeModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="form-veiculacao-lote">
            <div class="form-group">
              <label>Arquivo *</label>
              <select id="lote-arquivo" required></select>
            </div>
            <div class="form-row">
              <div class="form-group">
                <label>Data *</label>
                <input type="date" id="lote-data" required />
              </div>
              <div class="form-group">
                <label>Frequência *</label>
                <select id="lote-frequencia" required>
                  <option value="102.7">102.7</option>
                  <option value="104.7">104.7</option>
                </select>
              </div>
            </div>
            <div class="form-group">
              <label>Tipo de Programa</label>
              <input type="text" id="lote-tipo-programa" placeholder="esporte, jornal..." />
            </div>
            <div class="form-group">
              <label>Horários (um por linha) *</label>
              <textarea id="lote-horarios" rows="6" placeholder="11:00&#10;11:30&#10;12:05"></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" onclick="closeModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="saveLoteVeiculacoes()">Salvar Lote</button>
        </div>
      </div>
    </div>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/api.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/dashboard.js"></script>
    <script src="js/clientes.js"></script>
    <script src="js/contratos.js"></script>
    <script src="js/notas_fiscais.js"></script>
    <script src="js/veiculacoes.js"></script>
    <script src="js/arquivos.js"></script>
    <script src="js/usuarios.js"></script>
    <script src="js/app.js"></script>
  </body>
</html>
